(this["webpackJsonpreact-redux-app"]=this["webpackJsonpreact-redux-app"]||[]).push([[0],{26:function(e,t,n){e.exports=n(49)},47:function(e,t,n){},48:function(e,t,n){},49:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(10),c=n.n(o),l=n(7),i=n(8),s=n(2),u=[],p=!1;function h(e,t){var n=[];return e.forEach((function(e){new Date(1e3*e.date).getFullYear()===t&&n.push(e)})),n.sort((function(e,t){return t.likes.count-e.likes.count})),n}function d(e){return function(t){(t({type:"GET_PHOTOS_REQUEST",payload:e}),p)?t({type:"GET_PHOTOS_SUCCESS",payload:h(u,e)}):function e(t,n,a,r){VK.Api.call("photos.getAll",{extended:1,count:n,offset:t,v:"5.80"},(function(o){try{if(u=u.concat(o.response.items),t<=o.response.count)e(t+=200,n,a,r);else{var c=h(u,a);p=!0,r({type:"GET_PHOTOS_SUCCESS",payload:c})}}catch(l){r({type:"GET_PHOTOS_FAIL",error:!0,payload:new Error(l)})}}))}(0,200,e,t)}}var m={year:2020,photos:[],isFetching:!1,error:"",showModal:!1};var O={name:"",isFetching:!1,age:25};function f(e,t){return e?function(e){e({type:"OPEN_MODAL",payload:t})}:function(e){e({type:"CLOSE_MODAL",payload:t})}}var g={showModal:!1,fullSizeImg:""};var E=Object(i.c)({page:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_PHOTOS_REQUEST":return Object(s.a)(Object(s.a)({},e),{},{year:t.payload,isFetching:!0,error:""});case"GET_PHOTOS_SUCCESS":return Object(s.a)(Object(s.a)({},e),{},{photos:t.payload,isFetching:!1,error:""});case"GET_PHOTOS_FAIL":return Object(s.a)(Object(s.a)({},e),{},{error:t.payload.message,isFetching:!1});default:return e}},user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN_REQUEST":return Object(s.a)(Object(s.a)({},e),{},{isFetching:!0,error:""});case"LOGIN_SUCCESS":return Object(s.a)(Object(s.a)({},e),{},{isFetching:!1,name:t.payload});case"LOGIN_FAIL":return Object(s.a)(Object(s.a)({},e),{},{isFetching:!1,error:t.payload.message});default:return e}},modal:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"OPEN_MODAL":return Object(s.a)(Object(s.a)({},e),{},{showModal:!0,fullSizeImg:t.payload});case"CLOSE_MODAL":return Object(s.a)(Object(s.a)({},e),{},{showModal:!1});default:return e}}}),y=n(21),v=n.n(y),b=n(22),j=Object(i.d)(E,Object(i.a)(b.a,v.a)),S=n(3),C=n(4),k=n(6),w=n(5),T=n(23),_=n.n(T),M=function(e){Object(k.a)(n,e);var t=Object(w.a)(n);function n(){var e;Object(S.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).handlerCloseModal=function(t){e.props.togglerModal(!1,"")},e.handleAfterOpenFunc=function(){var e=document.querySelector(".modal");document.querySelector(".modal img").addEventListener("load",(function(t){e.style.left=document.documentElement.clientWidth/2-e.offsetWidth/2+"px"}))},e}return Object(C.a)(n,[{key:"render",value:function(){return r.a.createElement(_.a,{shouldCloseOnEsc:!0,shouldCloseOnOverlayClick:!0,onRequestClose:this.handleCloseModal,closeTimeoutMS:200,overlayClassName:"overlay",className:"modal",onAfterOpen:this.handleAfterOpenFunc,isOpen:this.props.showModal,contentLabel:"modal",appElement:document.body},r.a.createElement("img",{src:this.props.link,alt:""}),r.a.createElement("button",{onClick:this.handlerCloseModal},"X"))}}]),n}(r.a.Component),L=Object(l.b)((function(e){return{showModal:e.modal.showModal,link:e.modal.fullSizeImg}}),(function(e){return{togglerModal:function(t,n){return e(f(t,n))}}}))(M),A=n(24),F=n(25),N=function(e){Object(k.a)(n,e);var t=Object(w.a)(n);function n(){var e;Object(S.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).onBtnClick=function(t){var n=+t.currentTarget.innerText;e.props.getPhotos(n)},e.handlerOpenModal=function(t){e.props.togglerModal(!0,t.target.dataset.link)},e}return Object(C.a)(n,[{key:"componentDidMount",value:function(){this.props.getPhotos(2019)}},{key:"renderTemplate",value:function(){var e=this,t=this.props,n=t.photos,a=t.isFetching;return t.error?r.a.createElement("p",{className:"error"},"\u041f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u0432\u043e\u0437\u043d\u0438\u043a\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430:( \u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u0435 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443!"):a?r.a.createElement("p",null,"Loading... Please wait."):n.map((function(t){return r.a.createElement("div",{key:t.id},r.a.createElement("div",{className:"wrap"},r.a.createElement("img",{onClick:e.handlerOpenModal,src:t.sizes[2].url,alt:"","data-link":t.sizes[t.sizes.length-1].url})),r.a.createElement("p",{className:"like-count"},t.likes.count,r.a.createElement(A.a,{icon:F.a})))}))}},{key:"renderButton",value:function(){var e=this;return[2020,2019,2018,2017,2016,2015,2014,2013].map((function(t,n){return r.a.createElement("button",{onClick:e.onBtnClick,key:n},t)}))}},{key:"render",value:function(){var e=this.props,t=e.year,n=e.photos;return r.a.createElement("div",null,r.a.createElement("div",{className:"btn-block"},r.a.createElement("h2",null,"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0433\u043e\u0434"),this.renderButton()),r.a.createElement("p",{className:"photos-info"},"\u0423 \u0432\u0430\u0441 ",n.length,"  \u0444\u043e\u0442\u043e \u0437\u0430 ",t," \u0433\u043e\u0434"),r.a.createElement("div",{className:"grid"},this.renderTemplate()),r.a.createElement(L,null))}}]),n}(r.a.Component),P=function(e){Object(k.a)(n,e);var t=Object(w.a)(n);function n(){return Object(S.a)(this,n),t.apply(this,arguments)}return Object(C.a)(n,[{key:"render",value:function(){return r.a.createElement(N,{error:this.props.page.error,isFetching:this.props.page.isFetching,photos:this.props.page.photos,year:this.props.page.year,getPhotos:this.props.getPhotos,togglerModal:this.props.togglerModal})}}]),n}(r.a.Component),I=Object(l.b)((function(e){return{page:e.page}}),(function(e){return{getPhotos:function(t){return e(d(t))},togglerModal:function(t,n){return e(f(t,n))}}}))(P),G=function(e){Object(k.a)(n,e);var t=Object(w.a)(n);function n(){var e;Object(S.a)(this,n);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return(e=t.call.apply(t,[this].concat(o))).renderTemplate=function(){var t=e.props,n=t.name,a=t.error,o=t.isFetching;return a?r.a.createElement("p",null,"\u0412\u043e \u0432\u0440\u0435\u043c\u044f \u0437\u0430\u043f\u0440\u043e\u0441\u0430 \u043f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430:( ",r.a.createElement("br",null),"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u0435 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443!"):o?r.a.createElement("p",null,"\u0417\u0430\u0433\u0440\u0443\u0436\u0430\u044e..."):n?r.a.createElement("p",null,"\u041f\u0440\u0438\u0432\u0435\u0442, ",n,"!"):r.a.createElement("button",{onClick:e.props.handleLogin},"\u0412\u043e\u0439\u0442\u0438")},e}return Object(C.a)(n,[{key:"render",value:function(){return r.a.createElement("div",null,this.renderTemplate())}}]),n}(r.a.Component),U=function(e){Object(k.a)(n,e);var t=Object(w.a)(n);function n(){return Object(S.a)(this,n),t.apply(this,arguments)}return Object(C.a)(n,[{key:"render",value:function(){return r.a.createElement(G,{name:this.props.user.name,error:this.props.user.error,isFetching:this.props.user.isFetching,handleLogin:this.props.handleLogin})}}]),n}(r.a.Component),H=Object(l.b)((function(e){return{user:e.user}}),(function(e){return{handleLogin:function(){return e((function(e){e({type:"LOGIN_REQUEST"}),VK.Auth.login((function(t){if(t.session){var n=t.session.user.first_name;e({type:"LOGIN_SUCCESS",payload:n})}else e({type:"LOGIN_FAIL",error:!0,payload:new Error("Auth Error")})}),4)}))}}}))(U),x=(n(47),function(e){Object(k.a)(n,e);var t=Object(w.a)(n);function n(){return Object(S.a)(this,n),t.apply(this,arguments)}return Object(C.a)(n,[{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement("header",{className:"App-header"},r.a.createElement("h1",{className:"App-title"},"\u041c\u043e\u0439 \u0442\u043e\u043f \u0444\u043e\u0442\u043e"),r.a.createElement(H,null)),r.a.createElement(I,null))}}]),n}(a.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(48);c.a.render(r.a.createElement(l.a,{store:j},r.a.createElement(x,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[26,1,2]]]);
//# sourceMappingURL=main.642a4658.chunk.js.map